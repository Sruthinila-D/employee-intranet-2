<!-- HEADER SECTION -->
<div class="expense-header">
  <h2>Expense Management</h2>

  <p-button
    label="Create Expense"
    icon="pi pi-plus"
    (onClick)="openDialog()">
  </p-button>
</div>

<!-- EXPENSE TABLE -->
<p-table [value]="expenses" class="mt-3">

  <ng-template pTemplate="header">
    <tr>
      <th>ID</th>
      <th>User</th>
      <th>Type</th>
      <th>Date</th>
      <th>Amount</th>
      <th>Status</th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-exp>
    <tr>
      <td>{{ exp.expense_id }}</td>
      <td>{{ exp.user_id }}</td>
      <td>{{ exp.expense_type }}</td>
      <td>{{ exp.expense_date | date:'dd-MM-yyyy' }}</td>
      <td>â‚¹{{ exp.amount }}</td>
      <td>{{ exp.status }}</td>
    </tr>
  </ng-template>

</p-table>



<!-- CREATE EXPENSE DIALOG -->
<p-dialog
  header="Create Expense"
  [(visible)]="showCreateDialog"
  [modal]="true"
  [style]="{ width: '500px' }">

  <!--    YOUR EXISTING FORM MOVED HERE -->

  <form #expenseForm="ngForm" (ngSubmit)="submitExpense()">

    <!-- USER -->
    <div class="form-field">
  <label>User</label>
  <input
    type="text"
    [value]="1"
    class="p-inputtext p-component"
    readonly />
</div>

    <!-- EXPENSE TYPE -->
    <div class="form-field">
      <label>Expense Type</label>
      <p-select
        [options]="expenseTypes"
        [(ngModel)]="expense.expense_type"
        name="expense_type"
        required>
      </p-select>
    </div>

    <!-- DATE -->
    <div class="form-field">
      <label>Date</label>
      <p-datepicker
        [(ngModel)]="expense.expense_date"
        name="expense_date"
        showIcon="true"
        dateFormat="dd-mm-yy">
      </p-datepicker>
    </div>

    <!-- AMOUNT -->
    <div class="form-field">
      <label>Amount</label>
      <p-inputNumber
        [(ngModel)]="expense.amount"
        name="amount"
        mode="currency"
        currency="INR"
        locale="en-IN">
      </p-inputNumber>
    </div>

    <!-- REASON -->
    <div class="form-field">
      <label>Reason</label>
      <textarea
        pTextarea
        [(ngModel)]="expense.reason"
        name="reason"
        rows="4">
      </textarea>
    </div>

    <!-- FILE -->
    <div class="form-field">
      <label>Upload Bill (PDF only)</label>
      <p-fileUpload
  mode="basic"
  name="bills"
  [customUpload]="true"
  (onSelect)="onFileSelected($event)"
  accept=".pdf"
  multiple="true">
</p-fileUpload>
    </div>
    <div *ngIf="selectedFiles.length > 0" style="margin-top:10px;">
  <p><strong>Selected Files:</strong></p>
  <ul>
    <li *ngFor="let file of selectedFiles">
      {{ file.name }} ({{ file.size / 1024 | number:'1.0-2' }} KB)
    </li>
  </ul>
</div>

    <!-- SUBMIT -->
    <div class="submit-area mt-3">
      <p-button
  type="submit"
  label="Submit"
  icon="pi pi-check">
</p-button>
    </div>

  </form>

</p-dialog>



<!-- SUCCESS DIALOG -->
<p-dialog
  [(visible)]="showSuccessDialog"
  [modal]="true"
  [closable]="false"
  [draggable]="false"
  [resizable]="false"
  [style]="{ width: '400px' }">

  <div style="text-align:center; padding:20px;">
    <i class="pi pi-check-circle"
       style="font-size:3rem; color:#16a34a;"></i>
    <h3 style="margin-top:15px;">
      Expense Created Successfully
    </h3>
  </div>

</p-dialog>